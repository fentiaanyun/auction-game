# 模块测试指南 🧪

## 📋 测试准备

### 1. 启动本地服务器

由于ES6模块不支持`file://`协议，必须使用HTTP服务器：

**方法一：使用Python**
```bash
# Python 3
python -m http.server 8000

# Python 2
python -m SimpleHTTPServer 8000
```

**方法二：使用Node.js**
```bash
# 安装http-server（如果未安装）
npm install -g http-server

# 启动服务器
http-server -p 8000
```

**方法三：使用VS Code Live Server**
- 安装Live Server扩展
- 右键点击`test-modules.html`
- 选择"Open with Live Server"

### 2. 访问测试页面

打开浏览器访问：
```
http://localhost:8000/test-modules.html
```

## 🧪 测试步骤

### 步骤1：打开测试页面

1. 启动本地服务器
2. 在浏览器中打开 `test-modules.html`
3. 打开浏览器开发者工具（F12）查看控制台

### 步骤2：运行单项测试

点击每个测试区域的"运行测试"按钮，查看测试结果：

1. **常量模块测试** - 测试常量是否正确导入
2. **工具函数测试** - 测试时间格式化、类别名称等功能
3. **存储模块测试** - 测试localStorage读写操作
4. **状态管理测试** - 测试状态读写和监听
5. **定时器测试** - 测试定时器管理功能
6. **日志模块测试** - 查看控制台日志输出
7. **认证模块测试** - 测试管理员检查和显示名称

### 步骤3：运行综合测试

点击"运行全部测试"按钮，一次性测试所有模块。

## ✅ 预期结果

### 常量模块
- ✅ 显示所有常量值
- ✅ 类别映射正确

### 工具函数
- ✅ 时间格式化：`180秒 -> 3:00`
- ✅ 类别名称：`painting -> 油画`
- ✅ 金额格式化：`10000 -> ¥10,000`

### 存储模块
- ✅ 拍卖品存储/读取成功
- ✅ 用户存储/读取成功

### 状态管理
- ✅ 状态读写正常
- ✅ 状态监听器触发

### 定时器
- ✅ 定时器创建成功
- ✅ 定时器执行正常

### 日志模块
- ✅ 控制台显示带前缀的日志
- ✅ 不同级别的日志正确显示

### 认证模块
- ✅ 管理员检查正确
- ✅ 显示名称格式化正确

## 🐛 常见问题

### 问题1：模块加载失败

**错误信息**：
```
Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of "text/html"
```

**解决方法**：
- 确保使用HTTP服务器，而不是直接打开文件
- 检查文件路径是否正确
- 确保所有模块文件都存在

### 问题2：CORS错误

**错误信息**：
```
Access to script at 'file:///...' from origin 'null' has been blocked by CORS policy
```

**解决方法**：
- 必须使用HTTP服务器
- 不能直接双击HTML文件打开

### 问题3：模块未找到

**错误信息**：
```
Failed to resolve module specifier "modules/constants.js"
```

**解决方法**：
- 检查文件路径是否正确
- 确保使用相对路径：`./modules/constants.js`
- 确保文件扩展名`.js`存在

### 问题4：测试按钮无反应

**解决方法**：
- 打开浏览器控制台查看错误信息
- 检查是否有JavaScript错误
- 确保所有模块文件都已正确加载

## 📊 测试结果检查清单

- [ ] 所有模块都能正确导入
- [ ] 常量值正确显示
- [ ] 工具函数计算结果正确
- [ ] 存储操作成功（检查localStorage）
- [ ] 状态管理正常工作
- [ ] 定时器创建和执行正常
- [ ] 日志正确输出到控制台
- [ ] 认证功能正常

## 🔍 调试技巧

### 1. 查看控制台
打开浏览器开发者工具（F12），查看：
- Console标签：查看日志和错误
- Network标签：检查模块文件是否加载成功

### 2. 检查localStorage
在控制台输入：
```javascript
// 查看所有存储的数据
console.log(localStorage);

// 查看特定键
console.log(localStorage.getItem('auctions'));
```

### 3. 手动测试模块
在控制台输入：
```javascript
// 测试常量
import { AUCTION_CONFIG } from './modules/constants.js';
console.log(AUCTION_CONFIG);

// 测试工具函数
import { formatTime } from './modules/utils.js';
console.log(formatTime(180));
```

## 📝 测试报告模板

测试完成后，记录测试结果：

```
测试日期：2025-XX-XX
测试环境：Chrome/Firefox/Safari XX版本

模块测试结果：
✅ 常量模块 - 通过
✅ 工具函数模块 - 通过
✅ 存储模块 - 通过
✅ 状态管理模块 - 通过
✅ 定时器模块 - 通过
✅ 日志模块 - 通过
✅ 认证模块 - 通过

发现问题：
- 无

建议：
- 无
```

## 🎯 下一步

测试通过后，可以：
1. 开始迁移现有代码到新模块
2. 继续创建剩余模块（auction.js, ui.js等）
3. 更新主应用文件使用新模块

---

**祝测试顺利！** 🚀

